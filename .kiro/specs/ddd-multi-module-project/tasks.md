# 实施计划

## 任务列表

- [x] 1. 创建父 POM 和项目基础结构
  - 创建父 POM，配置项目基本信息和依赖管理
  - **验收标准**：
    - 运行 `mvn clean compile` 成功，输出 "BUILD SUCCESS"
    - 检查 pom.xml 文件，确认包含正确的 groupId、artifactId、version、packaging (pom)
    - 确认 properties 节包含 6 个版本属性（java.version, spring-boot.version, spring-cloud.version, mybatis-plus.version, aws-sdk.version, logback-json.version, micrometer-tracing.version）
    - 确认 dependencyManagement 节包含 2 个 BOM 导入（Spring Boot、Spring Cloud、Micrometer Tracing）和 3 个依赖声明（MyBatis-Plus、AWS SDK SQS、Logback JSON Encoder）
    - 确认 build 节包含 maven-compiler-plugin，source 和 target 设置为 21
    - 确认暂未声明任何子模块（modules 节为空或不存在）
  - _需求: 1.1, 1.2, 1.3, 1.4, 1.5, 11.1, 13.1, 14.1, 14.2, 14.3, 14.4_

- [x] 2. 创建 Common 通用模块
  - 创建 common 模块，实现统一的异常体系和响应类
  - 实现异常体系：BaseException（抽象类）、BusinessException、SystemException
  - 实现统一响应类 Result
  - **验收标准**：
    - 运行 `mvn clean compile` 成功，输出包含 "Building common" 和 "BUILD SUCCESS"
    - 检查 common/pom.xml，确认 parent 指向根 POM，packaging 为 jar
    - 确认 dependencies 节包含 lombok 依赖，且未指定版本号
    - 确认存在 4 个 Java 类：BaseException.java、BusinessException.java、SystemException.java、Result.java
    - 检查 BaseException 类，确认有 @Getter 注解、code 和 message 字段、protected 构造函数
    - 检查 BusinessException 和 SystemException 类，确认继承 BaseException
    - 检查 Result 类，确认有 @Data、@Builder、@NoArgsConstructor、@AllArgsConstructor 注解，有 success 和 error 静态方法
    - 确认根 POM 的 modules 节包含 `<module>common</module>`
  - _需求: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6_

- [x] 3. 创建 Domain 领域层模块结构
  - [x] 3.1 创建 domain 父模块
    - 创建 domain 父模块
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出包含 "Building domain" 和 "BUILD SUCCESS"
      - 检查 domain/pom.xml，确认 parent 指向根 POM，packaging 为 pom
      - 确认 domain/pom.xml 暂未声明任何子模块（modules 节为空或不存在）
      - 确认根 POM 的 modules 节包含 `<module>domain</module>`
    - _需求: 3.1, 3.5_
  
  - [x] 3.2 创建 domain-api 模块
    - 创建 domain-api 模块，定义领域模型结构
    - 创建包结构：model（aggregate、entity、vo）、event、service
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出包含 "Building domain-api" 和 "BUILD SUCCESS"
      - 检查 domain-api/pom.xml，确认 parent 指向 domain POM，packaging 为 jar
      - 确认 dependencies 节只包含 common 模块依赖，未指定版本号
      - 确认不依赖任何基础设施层模块（repository-api、cache-api、mq-api、mysql-impl、redis-impl、sqs-impl）
      - 确认存在包目录：model/aggregate、model/entity、model/vo、event、service
      - 确认 domain/pom.xml 的 modules 节包含 `<module>domain-api</module>`
    - _需求: 3.2, 3.3, 3.4_
  
  - [x] 3.3 创建 domain-impl 模块
    - 创建 domain-impl 模块
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出包含 "Building domain-impl" 和 "BUILD SUCCESS"
      - 检查 domain-impl/pom.xml，确认 parent 指向 domain POM，packaging 为 jar
      - 确认 dependencies 节包含 domain-api 和 common 模块依赖，未指定版本号
      - 确认存在包目录：service
      - 确认 domain/pom.xml 的 modules 节包含 `<module>domain-api</module>` 和 `<module>domain-impl</module>`
    - _需求: 4.1, 4.2, 4.3_

- [x] 4. 创建 Infrastructure 基础设施层模块结构
  - [x] 4.1 创建 infrastructure 父模块
    - 创建 infrastructure 父模块
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出包含 "Building infrastructure" 和 "BUILD SUCCESS"
      - 检查 infrastructure/pom.xml，确认 parent 指向根 POM，packaging 为 pom
      - 确认 infrastructure/pom.xml 暂未声明任何子模块
      - 确认根 POM 的 modules 节包含 `<module>infrastructure</module>`
    - _需求: 5.1, 5.8_
  
  - [x] 4.2 创建 repository 仓储模块
    - [x] 4.2.1 创建 repository 父模块
      - 创建 repository 父模块
      - **验收标准**：
        - 运行 `mvn clean compile` 成功，输出包含 "Building repository" 和 "BUILD SUCCESS"
        - 检查 infrastructure/repository/pom.xml，确认 parent 指向 infrastructure POM，packaging 为 pom
        - 确认 repository/pom.xml 暂未声明任何子模块
        - 确认 infrastructure/pom.xml 的 modules 节包含 `<module>repository</module>`
      - _需求: 5.2_
    
    - [x] 4.2.2 创建 repository-api 模块
      - 创建 repository-api 模块，定义仓储接口
      - 创建包结构：repository
      - **验收标准**：
        - 运行 `mvn clean compile` 成功，输出包含 "Building repository-api" 和 "BUILD SUCCESS"
        - 检查 repository-api/pom.xml，确认 parent 指向 repository POM，packaging 为 jar
        - 确认 dependencies 节包含 common 模块依赖，未指定版本号
        - 确认存在包目录：repository
        - 确认 repository/pom.xml 的 modules 节包含 `<module>repository-api</module>`
      - _需求: 5.3, 5.4_
    
    - [x] 4.2.3 创建 mysql-impl 模块
      - 创建 mysql-impl 模块，实现 MyBatis-Plus 数据访问
      - 添加依赖：repository-api、common、mybatis-plus-boot-starter、mysql-connector-j（scope: runtime）
      - **验收标准**：
        - 运行 `mvn clean compile` 成功，输出包含 "Building mysql-impl" 和 "BUILD SUCCESS"
        - 检查 mysql-impl/pom.xml，确认 parent 指向 repository POM，packaging 为 jar
        - 确认 dependencies 节包含 repository-api、common、mybatis-plus-boot-starter、mysql-connector-j 四个依赖
        - 确认 mybatis-plus-boot-starter 和 mysql-connector-j 依赖未指定版本号
        - 确认 mysql-connector-j 依赖的 scope 为 runtime
        - 确认存在包目录：mapper、entity、repository
        - 确认 repository/pom.xml 的 modules 节包含 `<module>repository-api</module>` 和 `<module>mysql-impl</module>`
      - _需求: 5.5, 5.6, 5.7_
  
  - [x] 4.3 创建 cache 缓存模块
    - [x] 4.3.1 创建 cache 父模块
      - 创建 cache 父模块
      - **验收标准**：
        - 运行 `mvn clean compile` 成功，输出包含 "Building cache" 和 "BUILD SUCCESS"
        - 检查 infrastructure/cache/pom.xml，确认 parent 指向 infrastructure POM，packaging 为 pom
        - 确认 cache/pom.xml 暂未声明任何子模块
        - 确认 infrastructure/pom.xml 的 modules 节包含 `<module>cache</module>`
      - _需求: 6.1_
    
    - [x] 4.3.2 创建 cache-api 模块
      - 创建 cache-api 模块，定义缓存接口
      - 创建包结构：cache
      - **验收标准**：
        - 运行 `mvn clean compile` 成功，输出包含 "Building cache-api" 和 "BUILD SUCCESS"
        - 检查 cache-api/pom.xml，确认 parent 指向 cache POM，packaging 为 jar
        - 确认 dependencies 节包含 common 模块依赖，未指定版本号
        - 确认存在包目录：cache
        - 确认 cache/pom.xml 的 modules 节包含 `<module>cache-api</module>`
      - _需求: 6.2, 6.3_
    
    - [x] 4.3.3 创建 redis-impl 模块
      - 创建 redis-impl 模块，实现 Redis 缓存
      - 添加依赖：cache-api、common、spring-boot-starter-data-redis
      - **验收标准**：
        - 运行 `mvn clean compile` 成功，输出包含 "Building redis-impl" 和 "BUILD SUCCESS"
        - 检查 redis-impl/pom.xml，确认 parent 指向 cache POM，packaging 为 jar
        - 确认 dependencies 节包含 cache-api、common、spring-boot-starter-data-redis 三个依赖
        - 确认 spring-boot-starter-data-redis 依赖未指定版本号
        - 确认存在包目录：config、cache
        - 确认 cache/pom.xml 的 modules 节包含 `<module>cache-api</module>` 和 `<module>redis-impl</module>`
      - _需求: 6.4, 6.5, 6.6_
  
  - [x] 4.4 创建 mq 消息队列模块
    - [x] 4.4.1 创建 mq 父模块
      - 创建 mq 父模块
      - **验收标准**：
        - 运行 `mvn clean compile` 成功，输出包含 "Building mq" 和 "BUILD SUCCESS"
        - 检查 infrastructure/mq/pom.xml，确认 parent 指向 infrastructure POM，packaging 为 pom
        - 确认 mq/pom.xml 暂未声明任何子模块
        - 确认 infrastructure/pom.xml 的 modules 节包含 `<module>mq</module>`
      - _需求: 7.1_
    
    - [x] 4.4.2 创建 mq-api 模块
      - 创建 mq-api 模块，定义消息队列接口
      - 创建包结构：producer
      - **验收标准**：
        - 运行 `mvn clean compile` 成功，输出包含 "Building mq-api" 和 "BUILD SUCCESS"
        - 检查 mq-api/pom.xml，确认 parent 指向 mq POM，packaging 为 jar
        - 确认 dependencies 节包含 common 模块依赖，未指定版本号
        - 确认存在包目录：producer
        - 确认 mq/pom.xml 的 modules 节包含 `<module>mq-api</module>`
      - _需求: 7.2, 7.3_
    
    - [x] 4.4.3 创建 sqs-impl 模块
      - 创建 sqs-impl 模块，实现 AWS SQS 消息队列
      - 添加依赖：mq-api、common、sqs（groupId: software.amazon.awssdk）
      - **验收标准**：
        - 运行 `mvn clean compile` 成功，输出包含 "Building sqs-impl" 和 "BUILD SUCCESS"
        - 检查 sqs-impl/pom.xml，确认 parent 指向 mq POM，packaging 为 jar
        - 确认 dependencies 节包含 mq-api、common、sqs (groupId: software.amazon.awssdk) 三个依赖
        - 确认 sqs 依赖未指定版本号
        - 确认存在包目录：config、producer
        - 确认 mq/pom.xml 的 modules 节包含 `<module>mq-api</module>` 和 `<module>sqs-impl</module>`
      - _需求: 7.4, 7.5, 7.6_
  
  - [x] 4.5 更新 domain-impl 模块依赖
    - 添加基础设施层 API 依赖到 domain-impl 模块
    - 添加依赖：repository-api、cache-api、mq-api（不包含实现模块）
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出 "BUILD SUCCESS"
      - 检查 domain-impl/pom.xml，确认 dependencies 节包含 domain-api、repository-api、cache-api、mq-api、common 五个依赖
      - 确认所有依赖未指定版本号
      - 确认不直接依赖基础设施实现模块（mysql-impl、redis-impl、sqs-impl）
    - _需求: 7.7, 15.2_

- [x] 5. 创建 Application 应用层模块结构
  - [x] 5.1 创建 application 父模块
    - 创建 application 父模块
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出包含 "Building application" 和 "BUILD SUCCESS"
      - 检查 application/pom.xml，确认 parent 指向根 POM，packaging 为 pom
      - 确认 application/pom.xml 暂未声明任何子模块
      - 确认根 POM 的 modules 节包含 `<module>application</module>`
    - _需求: 8.1, 8.8_
  
  - [x] 5.2 创建 application-api 模块
    - 创建 application-api 模块，定义应用服务接口
    - 创建包结构：service、dto、command、query
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出包含 "Building application-api" 和 "BUILD SUCCESS"
      - 检查 application-api/pom.xml，确认 parent 指向 application POM，packaging 为 jar
      - 确认 dependencies 节包含 common 模块依赖，未指定版本号
      - 确认存在包目录：service、dto、command、query
      - 确认 application/pom.xml 的 modules 节包含 `<module>application-api</module>`
    - _需求: 8.2, 8.3_
  
  - [x] 5.3 创建 application-impl 模块
    - 创建 application-impl 模块
    - 添加依赖：application-api、domain-api、common（不包含基础设施实现模块）
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出包含 "Building application-impl" 和 "BUILD SUCCESS"
      - 检查 application-impl/pom.xml，确认 parent 指向 application POM，packaging 为 jar
      - 确认 dependencies 节包含 application-api、domain-api、common 三个依赖，未指定版本号
      - 确认不直接依赖基础设施层的实现模块（mysql-impl、redis-impl、sqs-impl）
      - 确认存在包目录：service
      - 确认 application/pom.xml 的 modules 节包含 `<module>application-api</module>` 和 `<module>application-impl</module>`
    - _需求: 8.4, 8.5, 8.6, 8.7, 15.3_

- [x] 6. 创建 Interface 接口层模块结构
  - [x] 6.1 创建 interface 父模块
    - 创建 interface 父模块
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出包含 "Building interface" 和 "BUILD SUCCESS"
      - 检查 interface/pom.xml，确认 parent 指向根 POM，packaging 为 pom
      - 确认 interface/pom.xml 暂未声明任何子模块
      - 确认根 POM 的 modules 节包含 `<module>interface</module>`
    - _需求: 9.1, 9.10_
  
  - [x] 6.2 创建 http 模块
    - 创建 http 模块，实现 REST API 接口
    - 添加依赖：application-api、common、spring-boot-starter-web、spring-boot-starter-validation
    - 创建包结构：controller、request、response、exception
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出包含 "Building http" 和 "BUILD SUCCESS"
      - 检查 http/pom.xml，确认 parent 指向 interface POM，packaging 为 jar
      - 确认 dependencies 节包含 application-api、common、spring-boot-starter-web、spring-boot-starter-validation 四个依赖
      - 确认所有依赖未指定版本号
      - 确认不直接依赖领域层（domain-api、domain-impl）或基础设施层模块
      - 确认存在包目录：controller、request、response、exception
      - 确认 interface/pom.xml 的 modules 节包含 `<module>http</module>`
    - _需求: 9.2, 9.3, 9.4, 9.5, 9.6, 15.4_
  
  - [x] 6.3 创建 consumer 模块
    - 创建 consumer 模块，实现消息消费者
    - 添加依赖：application-api、common
    - 创建包结构：listener、handler、exception
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出包含 "Building consumer" 和 "BUILD SUCCESS"
      - 检查 consumer/pom.xml，确认 parent 指向 interface POM，packaging 为 jar
      - 确认 dependencies 节包含 application-api、common 两个依赖，未指定版本号
      - 确认不直接依赖领域层（domain-api、domain-impl）或基础设施层模块
      - 确认存在包目录：listener、handler、exception
      - 确认 interface/pom.xml 的 modules 节包含 `<module>http</module>` 和 `<module>consumer</module>`
    - _需求: 9.7, 9.8, 9.9, 15.4_

- [x] 7. 实现 HTTP 模块全局异常处理器
  - 实现 HTTP 全局异常处理器
  - 使用 @RestControllerAdvice 注解
  - 实现 4 个异常处理方法：handleBusinessException、handleSystemException、handleValidationException、handleException
  - **验收标准**：
    - 运行 `mvn clean compile` 成功，输出 "BUILD SUCCESS"
    - 确认存在文件：http/src/main/java/com/catface/order/traffic/http/exception/GlobalExceptionHandler.java
    - 检查 GlobalExceptionHandler 类，确认有 @RestControllerAdvice 注解
    - 确认包含 4 个方法：handleBusinessException (处理 BusinessException)、handleSystemException (处理 SystemException)、handleValidationException (处理 MethodArgumentNotValidException)、handleException (处理 Exception)
    - 确认每个方法都有 @ExceptionHandler 注解，返回类型为 Result<?>
    - 确认 handleBusinessException 和 handleSystemException 返回 Result.error(e.getCode(), e.getMessage())
    - 确认 handleValidationException 返回参数校验错误信息，错误码为 "VALIDATION_ERROR"
    - 确认 handleException 返回通用错误信息 "系统错误，请稍后重试"，错误码为 "SYSTEM_ERROR"
  - _需求: 12.1, 12.2, 12.3, 12.4, 12.5_

- [x] 8. 实现 Consumer 模块全局异常处理器
  - 实现 Consumer 全局异常处理器
  - 使用 @ControllerAdvice 和 @Slf4j 注解
  - 实现 3 个异常处理方法，使用 log.error 记录日志（不返回响应）
  - **验收标准**：
    - 运行 `mvn clean compile` 成功，输出 "BUILD SUCCESS"
    - 确认存在文件：consumer/src/main/java/com/catface/order/traffic/consumer/exception/ConsumerExceptionHandler.java
    - 检查 ConsumerExceptionHandler 类，确认有 @ControllerAdvice 和 @Slf4j 注解
    - 确认包含 3 个方法：handleBusinessException (处理 BusinessException)、handleSystemException (处理 SystemException)、handleException (处理 Exception)
    - 确认每个方法都有 @ExceptionHandler 注解，返回类型为 void
    - 确认每个方法都使用 log.error 记录 ERROR 级别日志，包含异常类型、错误消息和堆栈信息
  - _需求: 12.6, 12.7_

- [x] 9. 创建 Bootstrap 启动模块
  - [x] 9.1 创建 bootstrap 模块基础结构
    - 创建 bootstrap 模块，组装所有实现模块
    - 添加依赖：http、consumer、application-impl、domain-impl、mysql-impl、redis-impl、sqs-impl、common
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出包含 "Building bootstrap" 和 "BUILD SUCCESS"
      - 检查 bootstrap/pom.xml，确认 parent 指向根 POM，packaging 为 jar
      - 确认 dependencies 节包含 8 个模块依赖：http、consumer、application-impl、domain-impl、mysql-impl、redis-impl、sqs-impl、common
      - 确认所有依赖未指定版本号
      - 确认根 POM 的 modules 节包含 `<module>bootstrap</module>`
    - _需求: 10.1, 10.2, 10.3, 10.4, 10.5, 10.6, 10.7, 10.8, 10.9, 10.13_
  
  - [x] 9.2 添加监控和追踪依赖
    - 添加监控和追踪依赖到 bootstrap 模块
    - 添加依赖：spring-boot-starter-actuator、micrometer-registry-prometheus、micrometer-tracing-bridge-brave、logstash-logback-encoder
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出 "BUILD SUCCESS"
      - 检查 bootstrap/pom.xml，确认 dependencies 节包含 4 个新增依赖：spring-boot-starter-actuator、micrometer-registry-prometheus、micrometer-tracing-bridge-brave、logstash-logback-encoder
      - 确认所有依赖未指定版本号
    - _需求: 11.1, 11.2, 11.3, 13.1, 13.2, 13.3_
  
  - [x] 9.3 创建主启动类
    - 创建 Spring Boot 主启动类
    - 使用 @SpringBootApplication 注解，设置 scanBasePackages 为 "com.catface.order"
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出 "BUILD SUCCESS"
      - 确认存在文件：bootstrap/src/main/java/com/catface/order/bootstrap/OrderServiceApplication.java
      - 检查 OrderServiceApplication 类，确认有 @SpringBootApplication 注解，scanBasePackages 属性值为 "com.catface.order"
      - 确认有 main 方法，调用 SpringApplication.run(OrderServiceApplication.class, args)
    - _需求: 10.10_
  
  - [x] 9.4 配置 Spring Boot Maven 插件
    - 配置 Spring Boot Maven 插件
    - 配置 mainClass 为 com.catface.order.bootstrap.OrderServiceApplication
    - **验收标准**：
      - 运行 `mvn clean package` 成功，输出 "BUILD SUCCESS"
      - 检查 bootstrap/pom.xml，确认 build/plugins 节包含 spring-boot-maven-plugin
      - 确认插件配置中 mainClass 为 com.catface.order.bootstrap.OrderServiceApplication
      - 确认 bootstrap/target 目录下生成 order-service-bootstrap-1.0.0-SNAPSHOT.jar 文件
    - _需求: 17.2, 17.5_

- [x] 10. 创建配置文件
  - [x] 10.1 创建 application.yml
    - 创建主配置文件 application.yml
    - 配置应用名称、端口、Actuator 端点、Prometheus 指标、日志级别
    - **验收标准**：
      - 确认存在文件：bootstrap/src/main/resources/application.yml
      - 检查 application.yml，确认包含以下配置：
        - spring.application.name: order-service
        - spring.profiles.active: dev
        - server.port: 8080
        - management.endpoints.web.exposure.include: health,prometheus
        - management.metrics.export.prometheus.enabled: true
        - management.metrics.tags.application: ${spring.application.name}
        - management.metrics.enable.jvm: true
        - management.metrics.enable.http: true
        - management.metrics.enable.hikaricp: true
        - logging.level.root: INFO
        - logging.level.com.catface.order: DEBUG
    - _需求: 10.11, 13.4, 13.5, 16.4_
  
  - [x] 10.2 创建 bootstrap.yml
    - 创建 bootstrap 配置文件
    - 配置应用名称和配置中心开关（spring.cloud.config.enabled: false）
    - **验收标准**：
      - 确认存在文件：bootstrap/src/main/resources/bootstrap.yml
      - 检查 bootstrap.yml，确认包含以下配置：
        - spring.application.name: order-service
        - spring.cloud.config.enabled: false
    - _需求: 10.12_
  
  - [x] 10.3 创建多环境配置文件
    - 创建多环境配置文件（local、dev、test、staging、prod）
    - **验收标准**：
      - 确认存在 5 个文件：application-local.yml、application-dev.yml、application-test.yml、application-staging.yml、application-prod.yml
      - 检查 application-local.yml，确认日志级别配置：com.catface 包为 DEBUG，其他包为 INFO
      - 检查 application-dev.yml，确认日志级别配置：com.catface 包为 DEBUG，其他包为 INFO，数据库连接池大小为 5
      - 检查 application-test.yml，确认日志级别配置与 dev 环境一致
      - 检查 application-staging.yml，确认日志级别配置与 dev 环境一致
      - 检查 application-prod.yml，确认日志级别配置：所有包为 INFO，数据库连接池大小为 20
    - _需求: 16.1, 16.2, 16.3, 16.4, 16.5_
  
  - [x] 10.4 创建 logback-spring.xml
    - 创建 Logback 配置文件，支持多环境差异化日志配置、JSON 格式和链路追踪
    - 使用 `<springProfile>` 标签区分不同环境的日志配置
    - **验收标准**：
      - 确认存在文件：bootstrap/src/main/resources/logback-spring.xml
      - 检查 logback-spring.xml，确认包含以下配置：
        - 定义 CONSOLE appender（默认格式，带颜色）和 JSON_FILE appender（JSON 格式）
        - JSON_FILE appender 使用 LogstashEncoder，包含 traceId、spanId、application 字段
        - 配置日志文件路径为 logs/application.log，按日期和大小滚动（100MB）
        - 使用 `<springProfile name="local">` 配置本地环境：输出到 CONSOLE，com.catface 包 DEBUG，其他包 INFO
        - 使用 `<springProfile name="dev,test,staging">` 配置非生产环境：输出到 JSON_FILE，com.catface 包 DEBUG，其他包 INFO，保留 30 天
        - 使用 `<springProfile name="prod">` 配置生产环境：输出到 JSON_FILE，所有包 INFO，保留 90 天
        - 配置异步日志输出（AsyncAppender），队列大小 512，丢弃阈值 0
    - _需求: 11.4, 11.5, 11.6, 11.7, 11.8, 11.9, 11.10, 11.11_

- [x] 11. 验证应用启动和基础功能
  - 启动应用，验证日志输出、端口监听、Actuator 端点、Prometheus 指标、JSON 日志格式
  - **验收标准**：
    - 运行 `mvn spring-boot:run -pl bootstrap`，应用成功启动
    - 检查控制台日志，确认包含 "Started OrderServiceApplication in"，无 ERROR 级别日志
    - 运行 `lsof -i :8080` 或 `netstat -an | grep 8080`，确认应用监听 8080 端口
    - 访问 http://localhost:8080/actuator/health，返回 HTTP 200，响应体包含 "status":"UP"
    - 访问 http://localhost:8080/actuator/prometheus，返回 HTTP 200，响应体包含 Prometheus 格式指标
    - 检查 Prometheus 响应，确认包含以下指标：jvm_memory_used_bytes、jvm_gc_pause_seconds、jvm_threads_live
    - 检查控制台日志，确认为 JSON 格式，包含字段：timestamp、level、thread、logger、traceId、spanId、message
    - 按 Ctrl+C 停止应用
  - _需求: 10.14, 10.15, 11.6, 13.6, 13.7_

- [x] 12. 验证多环境配置和日志输出
  - 使用不同的 profile 启动应用，验证配置文件加载和日志输出格式
  - **验收标准**：
    - 运行 `mvn spring-boot:run -pl bootstrap -Dspring-boot.run.arguments=--spring.profiles.active=local`，应用成功启动
    - 检查控制台日志，确认包含 "The following profiles are active: local"
    - 检查控制台日志，确认为默认格式（带颜色），不是 JSON 格式
    - 检查控制台日志，确认 com.catface 包日志级别为 DEBUG（有 DEBUG 级别日志输出）
    - 按 Ctrl+C 停止应用
    - 运行 `mvn spring-boot:run -pl bootstrap -Dspring-boot.run.arguments=--spring.profiles.active=dev`，应用成功启动
    - 检查控制台日志，确认包含 "The following profiles are active: dev"
    - 检查 logs/application.log 文件，确认日志为 JSON 格式，包含 traceId、spanId、application 字段
    - 检查 logs/application.log 文件，确认 com.catface 包日志级别为 DEBUG
    - 按 Ctrl+C 停止应用
    - 运行 `mvn spring-boot:run -pl bootstrap -Dspring-boot.run.arguments=--spring.profiles.active=prod`，应用成功启动
    - 检查控制台日志，确认包含 "The following profiles are active: prod"
    - 检查 logs/application.log 文件，确认日志为 JSON 格式，所有包日志级别为 INFO（无 DEBUG 级别日志）
    - 按 Ctrl+C 停止应用
  - _需求: 11.6, 11.7, 11.8, 16.7, 16.8, 16.11_

- [x] 13. 创建测试控制器验证异常处理
  - [x] 13.1 创建 HTTP 测试控制器
    - 创建测试控制器，用于验证异常处理
    - 创建 4 个测试端点：/test/business-exception、/test/system-exception、/test/validation、/test/unknown-exception
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出 "BUILD SUCCESS"
      - 确认存在文件：http/src/main/java/com/catface/order/traffic/http/controller/TestController.java
      - 检查 TestController 类，确认有 @RestController 和 @RequestMapping("/test") 注解
      - 确认包含 4 个端点方法，分别抛出 BusinessException、SystemException、参数校验异常、RuntimeException
    - _需求: 12.8, 12.9_
  
  - [x] 13.2 验证 HTTP 异常处理
    - 启动应用，访问测试端点，验证异常处理器返回正确的 JSON 响应
    - **验收标准**：
      - 运行 `mvn spring-boot:run -pl bootstrap`，应用成功启动
      - 访问 http://localhost:8080/test/business-exception，返回 JSON：{"code":"TEST_ERROR","message":"测试业务异常","data":null}
      - 访问 http://localhost:8080/test/system-exception，返回 JSON：{"code":"SYSTEM_ERROR","message":"测试系统异常","data":null}
      - 访问 http://localhost:8080/test/validation（发送无效参数），返回 JSON 包含 "code":"VALIDATION_ERROR"，不暴露系统内部细节
      - 访问 http://localhost:8080/test/unknown-exception，返回 JSON：{"code":"SYSTEM_ERROR","message":"系统错误，请稍后重试","data":null}
      - 按 Ctrl+C 停止应用
    - _需求: 12.8, 12.9_
  
  - [x] 13.3 创建 Consumer 测试监听器
    - 创建测试监听器，用于验证异常处理
    - **验收标准**：
      - 运行 `mvn clean compile` 成功，输出 "BUILD SUCCESS"
      - 确认存在文件：consumer/src/main/java/com/catface/order/traffic/consumer/listener/TestMessageListener.java
      - 检查 TestMessageListener 类，确认有 @Component 注解
      - 确认有 handleMessage 方法，根据参数值抛出 BusinessException、SystemException 或 RuntimeException
    - _需求: 12.10_
  
  - [x] 13.4 验证 Consumer 异常处理
    - 启动应用，通过创建测试端点或单元测试调用 TestMessageListener 方法，验证异常处理器记录正确的日志
    - **验收标准**：
      - 运行 `mvn spring-boot:run -pl bootstrap`，应用成功启动
      - 方式一（推荐）：在 http 模块创建临时测试端点 /test/consumer，注入 TestMessageListener 并调用其方法
      - 方式二：编写单元测试类，使用 @SpringBootTest 注解，注入 TestMessageListener 并调用其方法
      - 调用 TestMessageListener.handleMessage("business")，检查控制台日志，确认包含 ERROR 级别日志，包含 "Consumer business exception"、异常类型、错误消息和堆栈信息
      - 调用 TestMessageListener.handleMessage("system")，检查控制台日志，确认包含 ERROR 级别日志，包含 "Consumer system exception"、异常类型、错误消息和堆栈信息
      - 调用 TestMessageListener.handleMessage("unknown")，检查控制台日志，确认包含 ERROR 级别日志，包含 "Consumer unexpected exception" 和完整堆栈跟踪
      - 按 Ctrl+C 停止应用
    - _需求: 12.10_

- [x] 14. 验证模块依赖关系
  - 检查各模块的 pom.xml 文件，确认依赖关系符合 DDD 分层架构原则
  - **验收标准**：
    - 检查 domain-api/pom.xml，确认 dependencies 节只包含 common 模块，不包含任何 infrastructure 层模块（repository-api、cache-api、mq-api、mysql-impl、redis-impl、sqs-impl）
    - 检查 domain-impl/pom.xml，确认 dependencies 节包含 domain-api、repository-api、cache-api、mq-api、common，不包含 mysql-impl、redis-impl、sqs-impl
    - 检查 application-impl/pom.xml，确认 dependencies 节包含 application-api、domain-api、common，不包含任何 infrastructure 实现模块（mysql-impl、redis-impl、sqs-impl）
    - 检查 http/pom.xml，确认 dependencies 节只包含 application-api、common、spring-boot-starter-web、spring-boot-starter-validation，不包含 domain-api、domain-impl 或任何 infrastructure 模块
    - 检查 consumer/pom.xml，确认 dependencies 节只包含 application-api、common，不包含 domain-api、domain-impl 或任何 infrastructure 模块
    - 确认所有模块的依赖关系遵循单向依赖原则（外层依赖内层，内层不反向依赖外层）
  - _需求: 15.1, 15.2, 15.3, 15.4, 15.5_

- [x] 15. 验证项目构建
  - 执行完整的项目构建，验证编译、打包、JAR 文件可执行性
  - **验收标准**：
    - 运行 `mvn clean compile`，输出 "BUILD SUCCESS"，无 ERROR 或 WARNING 信息
    - 检查构建日志中的 "Reactor Build Order"，确认模块顺序符合依赖关系：
      - common
      - domain (domain-api, domain-impl)
      - infrastructure (repository-api, repository/mysql-impl, cache-api, cache/redis-impl, mq-api, mq/sqs-impl)
      - application (application-api, application-impl)
      - interface (http, consumer)
      - bootstrap
    - 运行 `mvn clean package`，输出 "BUILD SUCCESS"，无 ERROR 或 WARNING 信息
    - 检查 bootstrap/target 目录，确认存在 order-service-bootstrap-1.0.0-SNAPSHOT.jar 文件
    - 运行 `java -jar bootstrap/target/order-service-bootstrap-1.0.0-SNAPSHOT.jar`，应用成功启动，输出包含 "Started OrderServiceApplication"
    - 按 Ctrl+C 停止应用
  - _需求: 17.1, 17.2, 17.3, 17.4, 17.5_
