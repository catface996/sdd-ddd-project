# F16: 自定义报告模板

## 基本信息

- **Feature ID**: F16
- **Feature 名称**: 自定义报告模板
- **优先级**: P1（第二阶段）
- **状态**: 待开发
- **负责人**: 待分配
- **预计工作量**: 待评估

## 用户故事

作为运维工程师，我希望自定义报告模板，以便生成符合我需求的分析报告。

## 功能价值

- 灵活定制报告
- 满足不同场景需求
- 提升报告专业性

## 核心功能

### 1. 创建报告模板
- 选择模板类型（巡检、故障分析、根因分析）
- 填写模板基本信息
- 选择基础模板（可选）

### 2. 配置报告结构
- 添加章节
- 添加段落
- 添加列表
- 添加表格
- 添加图表
- 调整顺序

### 3. 配置数据绑定
- 绑定变量到数据源
- 配置数据过滤条件
- 配置数据聚合方式
- 配置数据格式化

### 4. 配置样式
- 字体和颜色
- 标题样式
- 段落样式
- 表格样式
- 图表样式

### 5. 预览模板
- 使用样例数据预览
- 实时预览效果
- 切换预览格式（Markdown/HTML/PDF）

### 6. 管理模板
- 保存模板
- 编辑模板
- 删除模板
- 复制模板
- 导入导出模板

## 验收标准

### AC1: 创建模板
**WHEN** 用户创建模板 **THEN** THE System **SHALL** 提供可视化编辑器

**WHEN** 用户添加章节 **THEN** THE System **SHALL** 支持拖拽调整顺序

### AC2: 数据绑定
**WHEN** 用户绑定变量 **THEN** THE System **SHALL** 提供可用变量列表

**WHEN** 用户配置数据源 **THEN** THE System **SHALL** 验证数据源有效性

### AC3: 预览模板
**WHEN** 用户预览模板 **THEN** THE System **SHALL** 使用样例数据渲染模板

**WHEN** 用户切换格式 **THEN** THE System **SHALL** 实时更新预览

### AC4: 使用模板
**WHEN** 用户使用模板生成报告 **THEN** THE System **SHALL** 按模板格式输出报告

**WHEN** 模板数据绑定错误 **THEN** THE System **SHALL** 显示错误信息

## 依赖关系

### 前置依赖
- F08: 查看 Agent 执行结果和报告

### 后置依赖
- 无

## 技术考虑

### 模板引擎
- 使用模板引擎（如 Thymeleaf、FreeMarker）
- 支持变量替换
- 支持条件渲染
- 支持循环渲染

### 可视化编辑器
- 拖拽式布局
- 所见即所得
- 实时预览

### 报告生成
- Markdown 渲染
- HTML 渲染
- PDF 生成（第二阶段）

## 界面设计要点

### 模板编辑器
- 左侧：组件库（章节、段落、表格、图表）
- 中间：编辑区域（拖拽式布局）
- 右侧：属性配置面板
- 顶部：工具栏（保存、预览、导出）

### 模板列表页面
- 模板列表（卡片或表格）
- 模板类型过滤
- 搜索功能
- 创建模板按钮

## 测试要点

### 功能测试
- 测试创建和编辑模板
- 测试数据绑定
- 测试预览功能
- 测试报告生成

### 兼容性测试
- 测试不同格式的报告生成
- 测试不同浏览器的兼容性

## 相关文档

- 需求文档: `doc/intent/blueprint.md` - 2.5 报告模板管理
- Feature List: `doc/intent/feature-list.md` - F16

---

**创建日期**: 2024-11-20  
**最后更新**: 2024-11-20  
**文档版本**: v1.0
